{% extends 'importDB/base.html' %}
{% load static %}
{% block content %}
{% load plotly_dash %}
{% load humanize %}


<div class="container-fluid">
    <!-- Page Heading -->
    <div class="d-sm-flex align-items-center justify-content-between mb-4">
      <h1 class="h3 mb-0 text-gray-800">Dashboard</h1>
      <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i class="fas fa-download fa-sm text-white-50"></i> Generate Report</a>
    </div>

    <!-- Content Row -->
    <div class="row">
      <!-- Earnings (Monthly) Card Example -->
      <div class="col-xl-3 col-md-6 mb-4">
        <div class="widget-ch widget-ch-hover br-br" >
          <div class="card border-left-primary shadow h-100 py-2 ">
            <div class="card-body">
              <div class="row no-gutters align-items-center">
                <div class="col ">
                  <div class="text-primary font-weight-bold mb-1"> จำนวนของนักวิจัย</div>
                  <div class="h6 mb-0 text-gray-800">{{ head_page.total_of_guys }} คน</div>
                </div>
                <div class="col-auto">
                  <i class="fas fa-user-alt fa-2x text-gray-300"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <!-- รายได้งานวิจัย -->
          
      <div class="col-xl-3 col-md-6 mb-4" onclick="location.href= '/revenues';">
        <div class="widget-ch widget-ch-hover br-br" >
          <div class="card border-left-success shadow h-100 py-2">
            <div class="card-body">
              <div class="row no-gutters align-items-center">
                <div class="col ">
                  <div class="text-success font-weight-bold text-uppercase mb-1">รายได้งานวิจัย ปี {{now_year}}</div>
                  <div class="h6 mb-0 text-gray-800">{{  head_page.total_of_budget| floatformat:2|intcomma }} บาท</div> 
                </div>
                <div class="col-auto ">
                  <i class="fas fa-money-bill-alt fa-2x text-gray-300"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Earnings (Monthly) Card Example -->
  
      <div class="col-xl-3 col-md-6 mb-4 " onclick="location.href= '/ranking';" >
        <div class="widget-ch widget-ch-hover br-br" >
          <div class="card border-left-info shadow h-100 py-2">
            <div class="card-body">
              <div class="row no-gutters align-items-center">
                <div class="col ">
                  <div class="text-info font-weight-bold text-uppercase mb-1" >จำนวนงานวิจัย ปี {{now_year}}</div>
                    <div class="row ">
                      <div class="col-auto ">  
                        <div class="h6 mb-0 text-gray-800"   >Scopus : {{head_page.num_of_pub_sco}} </div>
                      </div>
                      <div class="col-auto ">  
                        <div class="h6 mb-0 text-gray-800 float-left ">ISI : {{head_page.num_of_pub_isi}} </div>
                      </div>
                    </div>
                </div>
                <div class="col-auto ">
                  <i class="fas fa-book-open fa-2x text-gray-300"></i>    
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <!-- Pending Requests Card Example -->
      <div class="col-xl-3 col-md-6 mb-4" onclick="location.href= '/exFund';">
        <div class="widget-ch widget-ch-hover br-br" >
          <div class="card border-left-warning shadow h-100 py-2">
            <div class="card-body">
              <div class="row no-gutters align-items-center">
                <div class="col ">
                  <div class="text-warning font-weight-bold text-uppercase mb-1"> หน่วยงานที่เข้าร่วม </div>
                  <div class="h6 mb-0  text-gray-800"> {{head_page.num_of_networks}} หน่วยงาน </div>
                </div>
                <div class="col-auto">
                  <i class="fas fa-hands-helping fa-2x text-gray-300"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  </div>
</div>

<div class="container-fluid">
    <div class="row"  >
      <div class=" col-lg-7 col-sm-12 ml-5 mb-3 card pretty_container " style="width:100%;"> 
        <h5 class = "subtitle mt-3 mb-0"> &nbsp;Sum of Publication per Year</h5> 
          {{ line_chart_publication | safe }}
      </div>
      <div class=" col-lg-4 col-sm-12 mx-4 mb-3 " style="width:100%;">            
        <div class="row mb-3 " >
          <div class="card pretty_container" style="position: relative;width: 100%;height: 15rem;">
            <h5 class = "subtitle mt-3 mb-3 ml-3">&nbsp;Total Publications </h5> 
            <div class="card-body text-primary" style="text-align: center; font-size: 400%" >
              {{ total_publication |intcomma }}
            </div>
          </div>
        </div>
        <div class="row " >
          <div class="card pretty_container" style="position: relative;width: 100%;height: 15rem;">
            <h5 class = "subtitle mt-3 ml-3">&nbsp; H-index </h5> 
            <div class="card-body text-success" style="text-align: center; font-size: 400%" >
              {{ h_index |intcomma }}
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row ">
      <div class=" col-lg-7 col-sm-12 ml-5 mb-3 card pretty_container " style="width: 100%"> 
        <h5 class = "subtitle mt-3 mb-0"> &nbsp;Sum of Times Cited per Year</h5>       
          {{ line_chart_cited | safe }}
      </div>
      <div class=" col-lg-4 col-sm-12 mx-4 mb-3">            
        <div class="row mb-3" >
          <div class="card pretty_container" style="position: relative;width: 100%;height: 10rem;">
            <h5 class = "subtitle mt-3 mx-4 ml-3">&nbsp; Sum of Times Cited </h5> 
            <div class="card-body h2 text-info " >
               {{sum_cited|intcomma}}
            </div>
          </div>
        </div>
        <div class="row mb-3" >
          <div class="card pretty_container" style="position: relative;width: 100%;height: 10rem;">
            <h5 class = "subtitle mt-3 mb-3 mx-4">&nbsp; Average Citations per Item </h5> 
            <div class="card-body h2 text-info" >
              {{avg_per_items |floatformat:2|intcomma}}
            </div>
          </div>
        </div>
        <div class="row " >
          <div class="card pretty_container" style="position: relative;width: 100%;height: 10rem;">
            <h5 class = "subtitle mt-3 mb-3 mx-4">&nbsp; Average Citations per Year </h5> 
            <div class="card-body h2 text-info" >
              {{avg_per_year |floatformat:2|intcomma}}
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row"  >
      <div class=" col-lg-7 col-sm-12 ml-5 mb-3 card pretty_container" style="width:100%;"> 
        <h5 class = "subtitle mt-3 mb-0"> &nbsp;Web of Science Catagories </h5>    
        &nbsp;&nbsp;
          <select id="option" name="option" class="form-control ex2" style=" width:15%; " >
                <option value="bar_chart" selected><b>Bar Chart</b></option>
                <option value="tree_map"><b>Tree Map</b></option>
          </select>
          <span id="bar" name = 'bar'>
            {{ bar_chart | safe }}
          </span>
          <span id="tree" name = 'tree'>
            {{ tree_map | safe }}
          </span>
      </div>
      <div class=" col-lg-4 col-sm-12 mx-4 mb-3 card pretty_container" style="width:100%;">            
        <h5 class = "subtitle mt-3 mb-0">&nbsp; test </h5> 
        
      </div>
    </div>
</div>


{% endblock content %}

{% block js %}
<script>
$(document).ready( function () {
  $('#tree').hide();
} );

$('select').on('change', function() {
  var value = $(this).val();
  
  if (value == "bar_chart") {
     $('#bar').show();
     $('#tree').hide();
  } else if (value == "tree_map") {
    $('#tree').show();
     $('#bar').hide();
  }
});
</script>

{% endblock js %}
